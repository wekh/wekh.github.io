<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><meta name="color-scheme" content="dark light"><meta name="author" content="wekh"><meta name="description" content=""><meta name="keywords" content=""><title>office365 E5自动订阅</title><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="//at.alicdn.com/t/font_3242539_utq6ykfq7z.css"><link rel="stylesheet" light-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/github.min.css" dark-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/github-dark.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif" as="font"><link href="/style/index.css" rel="stylesheet"><meta name="generator" content="Hexo 7.1.1"></head><body><header class="page-header"><nav><ul class="router-list"><li class="nav-item"> <a href="/">主页</a></li><li class="nav-item"> <a href="/archives/">归档</a></li></ul><div class="mode-switch"><span class="iconfont icon-DarkTheme"></span></div></nav></header><main><section class="main-content"><section class="post-page"><div class="title-bar"><h1>office365 E5自动订阅</h1><div class="post-info"><span>2023-11-14 00:00:00</span><span class="tags"></span></div></div><article> <div class="content"><h2 id="使用-github-的-Action-功能实现-Microsoft-office-E5-订阅自动续订"><a href="#使用-github-的-Action-功能实现-Microsoft-office-E5-订阅自动续订" class="headerlink" title="使用 github 的 Action 功能实现 Microsoft office E5 订阅自动续订"></a>使用 github 的 Action 功能实现 Microsoft office E5 订阅自动续订</h2><h2 id="一、新建密钥"><a href="#一、新建密钥" class="headerlink" title="一、新建密钥"></a>一、新建密钥</h2><p>点击右上角头像，点击 Settings<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-1.png""><br>然后点击左侧最下面的 Developer settings，然后选择 Personal access tokens，点击 Generate new token 新建<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-2.png""><br>按照下面设置，然后点击最下面的 Generate new token<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-3.png""><br>然后保存好新生成的 token<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-4.png""></p>
<h2 id="二、导入-KeepAliveE5-代码到自己的储存库"><a href="#二、导入-KeepAliveE5-代码到自己的储存库" class="headerlink" title="二、导入 KeepAliveE5 代码到自己的储存库"></a>二、导入 KeepAliveE5 代码到自己的储存库</h2><p>打开 github 后点击右上角+号，点击import repository导入到自己的储存库<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-5.png""><br>仓库地址<code>https://gitlab.com/vcheckzen/KeepAliveE5.git</code> <img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-6.png""><br>导入完成后进入自己的仓库，然后在设置中将分支修改为<code>master</code></p>
<h2 id="三、开启-Action-功能"><a href="#三、开启-Action-功能" class="headerlink" title="三、开启 Action 功能"></a>三、开启 Action 功能</h2><p>如果进入自己的仓库后发现上面没有 Action，就进入 Settings 里面看一下<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-7.png""><br>把 Actions 里的 General 里的 Actions permissions 设置改为第一个，然后点击 save，就可以看到有 Action 了<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-8.png""></p>
<h2 id="四、新建-Secrets"><a href="#四、新建-Secrets" class="headerlink" title="四、新建 Secrets"></a>四、新建 Secrets</h2><p>打开 Settings 里的 Secrets，点击 Actions，点击 New repository secret<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-9.png""><br>可以看到仓库作者已经给出说明，PAT 就是第一步生成的 token，USER 就是 E5 邮箱，PASSWD 就是 E5 邮箱的密码，然后 Add secret<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-10.png""><br>把这三个分别添加上去<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-11.png""></p>
<h2 id="五、根据微软禁用安全默认值教程禁用安全默认值"><a href="#五、根据微软禁用安全默认值教程禁用安全默认值" class="headerlink" title="五、根据微软禁用安全默认值教程禁用安全默认值"></a>五、根据<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/azure/active-directory/fundamentals/security-defaults#disabling-security-defaults">微软禁用安全默认值教程</a>禁用安全默认值<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-12.png""></h2><h2 id="六、启动-Action-的注册-APP-工作流"><a href="#六、启动-Action-的注册-APP-工作流" class="headerlink" title="六、启动 Action 的注册 APP 工作流"></a>六、启动 Action 的注册 APP 工作流<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-13.png""></h2><p>然后等待，等待期间可以点击进去看运行的日志，运行到大概哪个步骤了，完成后点击日志中的 Register app 那一步<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-14.png""><br>如果最后显示是注册成功就可以了<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-15.png""></p>
<h2 id="七、启动-Action-的调用-API-工作流"><a href="#七、启动-Action-的调用-API-工作流" class="headerlink" title="七、启动 Action 的调用 API 工作流"></a>七、启动 Action 的调用 API 工作流<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-16.png""></h2><p>然后等待，等待期间可以点击进去看运行的日志，运行到大概哪个步骤了，完成后点击日志中的 Test Api 那一步<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-17.png""><br>可以看到最后已经成功了<img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" 
  class="img-loading" data-original="https://img.wekh.eu.org/E5/E5-18.png""><br>后面这个工作流就会每天自动调用 API，保证账号是在使用，从而得到微软自动续期</p>
</div></article><div class="copyright-wrapper"><p>原文作者:<a href="http://example.com">wekh</a></p><p>更新日期: 2024-03-27 19:33:42</p><p>版权声明: 本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class="post-pager"><div class="prev"><a href="/2023/12/07/%E7%94%B5%E8%84%91%E5%88%87%E6%8D%A2%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7/" title="win11从微软账户切换为本地账户">上一篇 win11从微软账户切换为本地账户</a></div><div class="next"> <a href="/2023/10/31/%E7%94%B5%E8%84%91%E8%BD%AF%E4%BB%B6/" title="电脑软件">下一篇 电脑软件</a></div></div></section></section></main><footer class="footer-page"><div><span>Powered by</span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a><span>| Theme</span><a target="_blank" rel="noopener" href="https://github.com/techmovie/hexo-theme-instapaper">instapaper</a></div></footer><script src="/scripts/dark.js"></script><script src="/scripts/post.js"></script></body></html>